# stratified-inference

Finite-sample, nonparametric inference on the mean for simple random and stratified samples from bounded populations. The R script `stratified_functions.R` contains many functions for computing nonparametric bounds and tests. I sketch some ideas in the markdowns and scripts, where the functions are employed in a few simulation studies. Specifically:

- `stratified_simulations.R`: runs a host of simulations of stratified hypothesis tests in the context of risk-limiting audits. Comparison audits are simulated with a few different allocation rules.

- `gaffke_bound.html`: contains material about the nonparametric bound suggested in [Gaffke (2004)](https://www.math.uni-magdeburg.de/institute/imst/ag_gaffke/files/pp1304.pdf) and [Learned-Miller and Thomas (2019)](https://arxiv.org/abs/1905.06208). This bound has great promise for sharp, non-parametric tests and confidence intervals for the mean of a bounded population. Some optimality results are demonstrated and the empirical performance of the Gaffke bound is assessed. It is not proven to be valid. The code to create the webpage is `gaffke_bound.Rmd`. 

- `valid_stratified_inference.html`: details an idea for conservative nonparametric inference on the mean of a finite population, where the population has been stratified and samples drawn by simple random sampling within strata. This generalizes ideas discussed in [Wendell and Schmee (1996)](https://www.jstor.org/stable/2291677), [Ottoboni et al (2018)](http://arxiv.org/abs/1809.04235), and [Stark (2019)](http://arxiv.org/abs/1911.10035). The basic idea is to maximize a combined p-value over possible allocations of the population mean to invidual strata. The idea is presented in some generality, and a number of possible approaches to compute and combine sequentially valid p-values are described. Simulations are run to examine empirical performance in a range of possible applications. The code to create the webpage is `valid_stratified_inference.Rmd`.
